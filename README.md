# README
![STEREO-D](https://github.com/alfredcurry/STEREO_D/assets/75268862/de424b24-61f4-4979-9a12-bc900b943d53)<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   width="589.34973mm"
   height="90.756973mm"
   viewBox="0 0 589.34973 90.756976"
   version="1.1"
   id="svg1"
   xml:space="preserve"
   inkscape:version="1.3.2 (091e20e, 2023-11-25)"
   sodipodi:docname="STEREO-D-full.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"><sodipodi:namedview
     id="namedview1"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:document-units="mm"
     inkscape:zoom="0.39763045"
     inkscape:cx="1013.5039"
     inkscape:cy="172.27051"
     inkscape:window-width="1680"
     inkscape:window-height="968"
     inkscape:window-x="193"
     inkscape:window-y="93"
     inkscape:window-maximized="0"
     inkscape:current-layer="layer1-2" /><defs
     id="defs1"><inkscape:path-effect
       effect="spiro"
       id="path-effect34"
       is_visible="true"
       lpeversion="1" /><inkscape:perspective
       sodipodi:type="inkscape:persp3d"
       inkscape:vp_x="0 : -264.74187 : 1"
       inkscape:vp_y="0 : 999.99993 : 0"
       inkscape:vp_z="210 : -264.74187 : 1"
       inkscape:persp3d-origin="105.00001 : -314.24186 : 1"
       id="perspective23" /><clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath14"><path
         id="path15"
         style="fill:#ff0000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:0.264583"
         d="M 22.387264,15.463139 V 136.31674 H 136.69657 V 95.16215 c -1.55043,0.278898 -3.51937,-0.888388 -4.51704,-3.856095 -0.13481,-0.401008 -0.27454,-0.800119 -0.41858,-1.197859 -1.37834,1.365345 -2.81289,2.629593 -4.30051,3.681944 -0.7391,0.522841 -1.5538,0.930294 -2.33061,1.395265 -1.1435,0.09869 -2.34867,0.680074 -3.43028,0.296105 -4.72825,-1.678498 -2.58653,-7.254568 -1.71411,-10.503752 0.22892,-0.776763 0.45956,-1.554662 0.69557,-2.331124 l -0.26459,-0.315741 c -5.53372,-6.43365 -10.98203,-13.001961 -17.26458,-18.728573 -1.1093,-0.902256 -1.58815,-1.340866 -2.66908,-2.083078 -0.30041,-0.206264 -1.021199,-0.239453 -0.920361,-0.589627 1.378261,-4.78613 1.266541,-6.198192 2.247921,-6.0818 0.32712,0.0388 0.77612,0.247471 1.44178,0.557589 2.04266,1.177972 4.12807,2.298694 6.2668,3.291271 6.23139,2.650495 12.60557,5.000934 19.26807,6.323647 0.37019,0.0668 0.74245,0.125336 1.11311,0.190685 1.28629,-0.560109 2.61254,-0.896744 4.07107,-0.877982 0.61496,0.0079 1.25313,0.07764 1.92133,0.217556 0.27257,0.08038 0.53747,0.171593 0.80409,0.260451 V 15.463139 Z m 77.623166,45.627705 c 0.17395,0.242832 0.33396,0.313354 0.48835,0.273886 -0.16256,-0.09165 -0.32598,-0.182004 -0.48835,-0.273886 z m 17.21704,7.572148 c 2.09092,2.339319 4.13474,4.721029 6.17585,7.101377 0.5509,-0.992757 1.2428,-2.003539 1.97301,-2.404507 0.0508,-0.02792 0.1046,-0.04841 0.15658,-0.07338 -0.95592,-0.49536 -1.49013,-1.47338 -1.38907,-2.609659 -2.3335,-0.577207 -4.639,-1.251508 -6.91637,-2.013831 z m 13.75213,3.363619 c -0.18304,0.127825 -0.36656,0.256328 -0.54725,0.381373 -0.32927,0.227864 -0.6521,0.42028 -0.96738,0.580842 0.38325,0.16905 0.76155,0.34634 1.10897,0.577742 1.25873,0.838369 2.2321,2.93302 3.04529,4.573365 1.05336,-1.381805 2.23299,-2.706108 3.07734,-4.233333 v -1.066086 c -1.91217,-0.216101 -3.81648,-0.503865 -5.71697,-0.813903 z m -4.9754,6.224426 c 0.0816,0.06615 0.16654,0.127926 0.24959,0.192238 -0.0201,-0.02342 -0.0381,-0.04858 -0.0589,-0.07132 -0.0509,-0.05545 -0.24918,-0.168301 -0.19068,-0.120922 z m 10.69237,6.413045 c -0.009,0.01029 -0.0171,0.02019 -0.0259,0.03049 0.009,0.02111 0.017,0.04245 0.0259,0.06356 z m -11.46184,6.295223 c -0.01,0.201441 -0.005,0.402532 0.0191,0.604099 0.0122,0.102574 0.19195,-0.180739 0.14625,-0.27337 -0.0734,-0.148764 -0.10426,-0.206325 -0.16537,-0.330729 z" /></clipPath></defs><g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-3.1363455,-13.39259)"><path
       id="path1"
       style="fill:#aa4400;stroke:#000000;stroke-width:3.91672;stroke-linejoin:bevel;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"
       d="m 542.3288,15.58846 a 45.067957,43.080685 0 0 0 -6.99047,1.044362 V 100.43257 A 45.067957,43.080685 0 0 0 568.72048,95.470992 45.067957,43.080685 0 0 0 584.65878,37.283577 45.067957,43.080685 0 0 0 542.3288,15.58846 Z" /><path
       d="m 186.74168,15.478937 v 85.891633 l 50.61281,-0.19017 c -15.84911,-1.591927 -27.05367,-14.316563 -32.44246,-27.755643 -0.22117,-0.55158 16.84469,-15 16.84469,-15 l -16.60072,-15 c 4.97985,-16.23101 18.89464,-27.11284 32.19849,-27.94582 z"
       style="fill:#666666;stroke:#000000;stroke-width:4.10837;stroke-linejoin:bevel;stroke-dasharray:none;paint-order:stroke fill markers"
       id="path3"
       sodipodi:nodetypes="cccscccc" /><path
       d="m 384.66795,15.446775 v 85.891635 l -50.61281,-0.19017 c 15.84911,-1.591929 27.05367,-14.316565 32.44246,-27.755645 0.22117,-0.55158 -16.84469,-15 -16.84469,-15 l 16.60072,-15 c -4.97985,-16.23101 -18.89464,-27.11284 -32.19849,-27.94582 z"
       style="fill:#666666;stroke:#000000;stroke-width:4.10837;stroke-linejoin:bevel;stroke-dasharray:none;paint-order:stroke fill markers"
       id="path3-1"
       sodipodi:nodetypes="cccscccc" /><g
       inkscape:label="Layer 1"
       id="layer1-2"
       transform="translate(394.27928,11.308989)"><ellipse
         style="fill:#666666;stroke:none;stroke-width:3.37519;stroke-linejoin:bevel;paint-order:stroke fill markers"
         id="path1-9"
         cx="48.409184"
         cy="47.528168"
         rx="43.312408"
         ry="43.312405" /><path
         id="path1-2"
         style="fill:#aa4400;stroke:#734538;stroke-width:0;stroke-linejoin:bevel;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"
         d="m 78.417314,16.322838 a 43.312408,43.312405 0 0 0 -13.45241,31.23685 43.312408,43.312405 0 0 0 13.38937,31.17381 43.312408,43.312405 0 0 0 13.38936,-31.17381 43.312408,43.312405 0 0 0 -13.32632,-31.23685 z" /><circle
         style="fill:#4d4d4d;stroke:#734538;stroke-width:0;stroke-linejoin:bevel;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"
         id="path2"
         cx="34.15596"
         cy="24.941164"
         r="5" /><circle
         style="fill:#4d4d4d;stroke:#734538;stroke-width:0;stroke-linejoin:bevel;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"
         id="path2-1"
         cx="19.337656"
         cy="57.522263"
         inkscape:transform-center-y="-37.09862"
         r="6.5" /><circle
         style="fill:#4d4d4d;stroke:#734538;stroke-width:0;stroke-linejoin:bevel;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"
         id="path2-9"
         cx="53.229145"
         cy="70.022263"
         inkscape:transform-center-x="15.131458"
         inkscape:transform-center-y="-5.3092837"
         r="4" /><ellipse
         style="fill:none;stroke:#000000;stroke-width:4;stroke-linejoin:bevel;stroke-dasharray:none;paint-order:stroke fill markers"
         id="path1-9-8"
         cx="48.409184"
         cy="47.528168"
         rx="43.312408"
         ry="43.312405"
         inkscape:transform-center-x="35.150731"
         inkscape:transform-center-y="-27.599833"
         inkscape:label="path1-9-8" /><ellipse
         style="fill:none;stroke-width:4;stroke-dasharray:none"
         id="path4"
         cx="-287.67322"
         cy="52.654007"
         rx="130.75111"
         ry="89.163612" /></g><path
       id="path1-7"
       style="fill:#666666;stroke:#000000;stroke-width:3.90535;stroke-linejoin:bevel;paint-order:stroke fill markers"
       d="m 291.08116,15.47726 -35.16267,0.438731 v 85.656089 h 20.03134 l 1.9e-4,-28.551794 20.03168,28.551794 h 20.03134 C 314.24553,99.664428 300.36772,75.254037 300.44629,73.020105 300.55647,69.887897 315.7864,49.437372 316.01309,44.468048 312.39148,40.846724 300.2134,25.921231 291.08116,15.47726 Z m -15.13114,28.990788 h 13.0205 V 53.9854 h -13.0205 z"
       sodipodi:nodetypes="cccccccsccccccc" /><path
       d="m 45.629735,15.551741 c -17.699946,1.6e-4 -31.458412,9.01262 -40.4380877,27.47338 -0.708191,1.45593 39.6644177,28.943315 39.8822677,29.999995 0,0 -39.9421067,-0.608 -39.7353167,0 6.1141587,17.97665 23.9544977,28.503214 40.2914067,28.503344 20.025288,-0.007 33.939228,-12.274654 40.570698,-28.503344 L 46.040935,43.025121 c 0.49632,0.86124 39.477028,0.45797 39.599758,0 -3.86409,-15.91778 -23.25422,-28.18099 -40.010958,-27.47338 z"
       style="fill:#666666;stroke:#000000;stroke-width:3.99492;stroke-linejoin:bevel;paint-order:stroke fill markers"
       id="path57"
       sodipodi:nodetypes="cscsccccc"
       inkscape:label="path57" /><path
       style="fill:#666666;fill-opacity:1;stroke:#000000;stroke-width:3.88376;stroke-linejoin:bevel;stroke-dasharray:none;paint-order:stroke fill markers"
       d="m 159.23357,15.466626 15.05245,29.16901 -32.32499,-0.36111 V 101.58288 H 112.35096 V 44.274526 H 97.545922 v -28.65417 z"
       id="path3-2"
       sodipodi:nodetypes="ccccccccc" /><ellipse
       style="fill:#aa4400;stroke:#000000;stroke-width:4;stroke-dasharray:none;stroke-opacity:1"
       id="path1-7-9"
       cx="509.31354"
       cy="60.172874"
       rx="10.170671"
       ry="10.170673" /></g></svg>



# STEREO-D
### Structural & Thermal Evolution of Rocky Exoplanets in One-Dimension

## INSTALLATION

The program uses the **BOOST** (https://www.boost.org/) and **EIGEN** (https://eigen.tuxfamily.org) header libraries. Both are easy to install as they are simply header files. The user can either place them in a standard 'include' directory or specify their locations with the variable PDIR in 'makefile'. Either make a 'packages' directory, or change it to your own.

In addition, the line:

`cardinal_cubic_hermite() = default;` and `pchip() = default;`

must be added as a public definition in the classes `cardinal_cubic_hermite` (boost/math/interpolators/cubic_hermite.hpp) and `pchip` (boost/math/interpolators/pchip.hpp) in order for the program's implementation of the class to work.

## OPERATION
To compile all executables run 

`make all`

or to compile individual executables run `make` followed by the executable name.

To run executables I have created `bash` scripts which are in the formate `run_???.sh` which both create folders to store results in and run the executables with the required input parameters. Either modify these, create new ones or use the scripts inside them. The required input parameters for the executbales (e.g., planet mass, grid resolution) are written in the `run_???.sh` scripts and the corresponding `.cc` files in `frontcodefiles`. I also include a `submit_???.pbs` file for use on HPC.

Units are SI, unless stated otherwise.

### Executable options
`MixStruct` - with "Mix" EoS and analyitc BCs (likely the desired method)

`SeaStruct` - with Seager analyitc EoS and analyitc BCs

`StixStruct` - with "Stixrude" EoS

`AbeStruct` - with "Abe" EoS

`BC_Struct` - with "Mix" EoS and tabulated EoS

`GenStruct` - Static strucuture with "Ideal" gas EoS

`GenStruct_Tab` - `GenStruct` - but with tabulated EoS

`TimeStruct` - time evolving structure with "Ideal" gas EoS

`IrrEnvStruct2` - with "Ideal" gas EoS, analyitc EoS and only models an atmospheric envelope (has an unresolved core)

`IrrEnvStruct2_Tab` - `IrrEnvStruct` but with tabulated EoS

#### Tests

`Struct_test_boost` - Tests that can reproduce the analytically derviable strucuture of a static n=1 polytrope

`Struct_test_boost_Tab` - `Struct_test_boost` but with tabulated EoS

`Poly_Time_test_boost` - Tests that can reproduce an analytically derivable time evolution of a polytrope with special boundary conditions (see my thesis)

`Poly_Time_test_boost_Tab` - `Poly_Time_test_boost` but with tabulated EoS

`Struct_test_boost_Irr` - Tests that can reproduce the 

`Struct_test_boost_Irr_Tab` - `Struct_test_boost_Irr` but with tabulated EoS


### Equation of state options
Equations of state are included at compile time and read in at the start. The equation of state options are 
"Mix" - Selected rocky equations of state with melting included and an optional iron core (EoSs are tabulated)
"Ideal" - analytic ideal gas EoS
"Ideal_Tab" - tabulated ideal gas EoS
"Abe" - Adaptation of "Mix" where Cp is set constant. Used to try to match results from Abe's 90s papers (not worth using)
"Seager" - Simple analyitic rock equation of state from Seager paper
"Stixrude" - EoS from Stxrude for enstatite. No melting or core.

### NABLA type codes

'i' - isothermal  
'a' - adiabatic  
'c' - mixing length convection (with latent heats)  
'B' - Bower formulation (latent heats in mixing length AND F_mix)  
'g' - 'c' but with gravitational settling

### MIXING LENGTH PRESCRIPTIONS 

'c' - constant R/4  
'n' - distance to nearest boundary 

### TEMPERATURE BOUNDARY CONDITIONS

'f' - fixed  
'b' - atmosphereless black body  
'i' - Irradiated atmosphere, Guillot (2010)  
'm' - modified black body with atmpshere of optical depth \tau  
'l' - analytic fit to our grid of boundary models

### PRESSURE BOUNDARY CONDITIONS

'f' - fixed  
'o' - atmosphere with specified opacity at particular \tau surface  
'c' - P propto R^-4 to keep self-similarity of polytropes  

### Outut files

"scale" FILE CONTAINS

`M_planet P_c R_edge T_c L_edge M_core R_core`

"results" FILE CONTAINS

`m P r T L (<-scaled to max value, unscaled ->) rho nabla nabla-nabla_Ad phi T_sol T_liq Errors(on P,r,T,L)`

"fluxes" FILE CONTAINS

`L_tot L_cond L_conv L_grav L_mix`

"other" FILE CONTAINS

`Cp del nu lmix DS DV u_conv`

"bulk" FILE depends on the exact planet specifications. 
FOR "MIX" EOS IT CONTANS

`time (yrs), P_c, R_edge, T_c, L_edge, P_surf, T_surf, r_RCB, r_solidus (upper), r_liquidus, r_{critical melt frac}, r_solidus (deeper), r_{5% melt frac} (upper), r_{5% melt frac} (deeper), E_grav, E_thermal, E_total, M_{edge of grid}, M_total, Mass loss, z_edge, M_CMB, R_CMB, L_CMB, T_CMB, m_solidus (upper), m_solidus (deeper), m_liquidus, m_{critical melt frac}, P_solidus (upper), P_solidus (deeper), P_liquidus, P_{critical melt frac}, phi_outer, T_1Gpa, dt (yrs), timestep number, grid size`

"mass" FILE is a reduced version just with properties related to mass evolution. 
IT CONTAINS

`time (yrs), M_total, M_dot (lost from planet), M_dot (from day to nightside), total mass lost from dayside, R_total`

## Plotting results
In the folder `plotting` I have placed some example scripts for plotting results. These will require modification to the user's particular desires.
